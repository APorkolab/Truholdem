<div class="game-table">
	<!-- Az opcionális láncolás használata az esetleges undefined értékek kezelésére -->
	<div *ngFor="let player of game?.players; let i = index" [ngClass]="{
      'user': !player.name?.startsWith('Bot'), 
      'left': i === 0, 
      'top': i === 1, 
      'right': i === 2
    }" class="player">

		<!-- Kártyák vízszintes elrendezése -->
		<div *ngFor="let card of player.hand" class="card">
			<img *ngIf="game?.phase === 'RIVER' || !player.name?.startsWith('Bot'); else backCard" [src]="getCardImage(card)"
				[alt]="card.value + ' of ' + card.suit" class="card-image">
			<ng-template #backCard>
				<img src="../../assets/cards/back.png" alt="Card Back" class="card-image">
			</ng-template>
		</div>


		<!-- Játékos információk -->
		<div class="player-info">
			<span>{{ player.name || 'Anonymous' }}</span>
			<span> Chips: {{ player.chips }}</span>
			<span *ngIf="player.folded"> Folded</span>
		</div>
	</div>

	<!-- Közösségi kártyák -->
	<div class="community-cards">
		<div *ngFor="let card of game?.communityCards" class="card">
			<img [src]="getCardImage(card)" [alt]="card.value + ' of ' + card.suit" class="card-image">
		</div>
	</div>

	<div class="actions">
		<button *ngIf="game?.phase !== 'RIVER'" (click)="fold()">Fold</button>
		<button *ngIf="game?.phase !== 'RIVER'" data-toggle="modal" data-target="#raiseModal">Raise</button>
		<button *ngIf="game?.phase !== 'RIVER'" (click)="allIn()">All-In</button>

		<!-- A raise Bootstrap modal -->
		<div class="modal fade" id="raiseModal" tabindex="-1" role="dialog" aria-labelledby="raiseModalLabel"
			aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="raiseModalLabel">Enter Raise Amount</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<input type="number" class="form-control" [(ngModel)]="raiseAmount" placeholder="Amount"
							[max]="playerChips" />
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
						<button type="button" class="btn btn-primary" (click)="raise(raiseAmount)">OK</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Game End Modal -->
		<div class="modal" tabindex="-1" id="gameEndModal">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title">Game Ended</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<p> </p>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
						<button type="button" class="btn btn-primary">Save changes</button>
					</div>
				</div>
			</div>
		</div>

		<div *ngIf="game?.pot">Pots: {{ game.currentPot }}</div>
		<button *ngIf="game?.phase === 'PRE_FLOP'" (click)="dealFlop()">Deal Flop</button>
		<button *ngIf="game?.phase === 'FLOP'" (click)="dealTurn()">Deal Turn</button>
		<button *ngIf="game?.phase === 'TURN'" (click)="dealRiver()">Deal River</button>
		<button *ngIf="game?.phase === 'RIVER'" (click)="endGame()">End Game</button>
	</div>
</div>